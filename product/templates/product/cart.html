{% extends 'base.html' %}
{% load static %}
{% load ecfilters %}

{% block content %}

{% if cart %}
<div class="col">
    <h3>Carrinho de compras</h3>
    <p class="lead">Os produtos, quantidades e preços que você escolheu.</p>

    <div class="table-responsive">
        <table class="table">
            <tr>
                <th class="d-none d-lg-block">Imagem</th>
                <th>Produto</th>
                <th>V.</th>
                <th>QTD.</th>
                <th>Total</th>
            </tr>

            {% for line in cart.values %}
            <tr>
                <td class="d-none d-lg-block">
                    <img class="cart-img shadow" src="{% get_media_prefix %}{{ line.image }}">
                </td>
                <td>
                    <a class='text-body' href="{% url 'product:details' line.slug %}">{{ line.product_name }}</a>
                        
                    {% if line.variation_id %}
                    <a class="ml-3" href="{% url 'product:del_from_cart' line.variation_id %}">
                        <i class="fas fa-times-circle text-danger" aria-hidden="true"></i>
                    </a>
                    {% else %}
                    <a class="ml-3" href="{% url 'product:del_from_cart' line.product_id %}">
                        <i class="fas fa-times-circle text-danger" aria-hidden="true"></i>
                    </a>
                    {% endif %}

                </td>
                {% if line.variation_name %}
                    <td>{{ line.variation_name }}</td>
                {% else %}
                    <td>Sem variação</td>
                {% endif %}

                {% if line.promotional_unit_price %}
                    <td>{{ line.quantity }} de {{ line.promotional_unit_price|currency }}</td>
                {% else %}
                    <td>{{ line.quantity }} de {{ line.unit_price|currency }}</td>
                {% endif %}

                {% if line.promotional_quant_price %}
                    <td>{{ line.promotional_quant_price|currency }}</td>
                {% else %}
                    <td>{{ line.quant_price|currency }}</td>
                {% endif %}
            </tr>
            {% endfor %}

        </table>
    </div>
</div>
</div>



<div class="row mt-3">
<div class="col-lg">
    <p class='lead'>Total no carrinho</p>

    <div class='table-responsive'>
        <table class="table">
            <tr>
                <td class="font-weight-bold">Total</td>
                <td>{{ cart|cart_total_value|currency }}</td>
            </tr>
        </table>
    </div>
</div>
<div class="col-lg mt-auto">
    <a class="btn btn-lg btn-block btn-primary" href="#">
        Finalizar a compra
    </a>
</div>

{% else %}
<div class="container text-center">
    <h1 class="display-4">Seu carrinho de compras está vazio no momento</h1>
    <p class="lead">Dê uma olhada nos nossos produtos <a href="{% url 'product:index' %}">clicando aqui</a>!</p>
</div>
{% endif %}

{% endblock content %}